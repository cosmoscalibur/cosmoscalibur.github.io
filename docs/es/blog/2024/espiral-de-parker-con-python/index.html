
<!DOCTYPE html>


<html lang="es" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Espiral de Parker con Python" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.cosmoscalibur.com/es/blog/2024/espiral-de-parker-con-python/" />
<meta property="og:site_name" content="Cosmoscalibur" />
<meta property="og:description" content="En esta entrada veremos la solución numérica a la ecuación diferencial no lineal de primer orden que modela la velocidad del viento solar en función de la distancia heliocéntrica. Una vez se obtien..." />
<meta property="og:image:width" content="1146" />
<meta property="og:image:height" content="600" />
<meta property="og:image" content="https://www.cosmoscalibur.com/_images/social_previews/summary_es_blog_2024_espiral-de-parker-con-python_ecbc4fb0.png" />
<meta property="og:image:alt" content="En esta entrada veremos la solución numérica a la ecuación diferencial no lineal de primer orden que modela la velocidad del viento solar en función de la di..." />
<meta name="description" content="En esta entrada veremos la solución numérica a la ecuación diferencial no lineal de primer orden que modela la velocidad del viento solar en función de la distancia heliocéntrica. Una vez se obtien..." />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@cosmoscalibur" />

    <title>Espiral de Parker con Python &#8212; Cosmoscalibur</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../../_static/documentation_options.js?v=a20647df"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/translations.js?v=f85f4cfb"></script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-4YFQBC69LB"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-4YFQBC69LB');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-4YFQBC69LB');
            </script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'es/blog/2024/espiral-de-parker-con-python';</script>
    <link rel="canonical" href="https://www.cosmoscalibur.com/es/blog/2024/espiral-de-parker-con-python/" />
    <link rel="icon" href="../../../../_static/cosmoscalibur_favicon.png"/>
    <link rel="index" title="Índice" href="../../../../genindex/" />
    <link rel="search" title="Búsqueda" href="../../../../search/" /> 

<!-- TODO: Revisar como hacer que dependa del despliegue en GitHub Pages para no usar en local -->
<!-- TODO: Usar GitHub Actions para esto -->

<!-- Usado para mostrar publicidad -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0356238418278924"
crossorigin="anonymous"></script>

 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../../../blog/atom.xml"
  title="Cosmoscalibur"
/>
  
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../search/"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../../">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/cosmoscalibur_logo.png" class="logo__image only-light" alt="Cosmoscalibur - Home"/>
    <img src="../../../../_static/cosmoscalibur_logo.png" class="logo__image only-dark pst-js-only" alt="Cosmoscalibur - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../me/">
    Edward Villegas
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Búsqueda</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/cosmoscalibur/" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/cosmoscalibur" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Búsqueda</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../me/">
    Edward Villegas
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/cosmoscalibur/" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/cosmoscalibur" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<div class="ablog-sidebar-item ablog__postcard">
   
  <h2>
     
    <span>2024-10-06</span>
    
  </h2>
  <ul>
    <div class="ablog-sidebar-item ablog__postcard2">
   
  <li id="ablog-sidebar-item author ablog__author">
    <span>
       Autor: 
    </span>
     
    <a href="../../../../blog/author/edward-villegas-pulgarin/">Edward Villegas-Pulgarin</a>
      
  </li>
    
  <li id="ablog-sidebar-item language ablog__language">
    <span>
       Idioma: 
    </span>
     
    <a href="../../../../blog/language/espanol/">Español</a>
      
  </li>
   
  <li id="ablog-sidebar-item category ablog__category">
    <span>
       Categoría: 
    </span>
     
    <a href="../../../../blog/category/ciencia/">ciencia</a>
     ,    
    <a href="../../../../blog/category/fisica-computacional/">física computacional</a>
      
  </li>
   
  <li id="ablog-sidebar-item tags ablog__tags">
    <span>
        Etiquetas:  
    </span>
     
    <a href="../../../../blog/tag/viento-solar/">viento solar</a>
        
    <a href="../../../../blog/tag/espiral-de-parker/">espiral de parker</a>
        
    <a href="../../../../blog/tag/metodo-de-runge-kutta/">método de runge kutta</a>
        
    <a href="../../../../blog/tag/python/">python</a>
        
    <a href="../../../../blog/tag/sympy/">sympy</a>
      
  </li>
   
</div>
  </ul>
</div>
</div>
        <div class="sidebar-primary-item">
<div class="ablog-sidebar-item ablog__recentposts">
  <h3>
    <a href="../../../../blog/">Entradas recientes</a>
  </h3>
  <ul>
     
    <li>
      <a href="../conecta-con-una-instancia-de-cloud-sql-en-manjaro/">
        2024-12-10 - Conecta con una instancia de Cloud SQL en Manjaro
      </a>
    </li>
    
    <li>
      <a href="../problemas-de-conexion-wifi-en-linux/">
        2024-12-07 - Problemas de conexión wifi en Linux
      </a>
    </li>
    
    <li>
      <a href="../que-hacer-despues-de-instalar-manjaro/">
        2024-12-05 - ¿Qué hacer después de instalar Manjaro KDE 24?
      </a>
    </li>
    
    <li>
      <a href="../distrohopping-cambiar-de-distribución-linux-y-no-morir-en-el-intento/">
        2024-12-03 - Distrohopping: Cambiar de distribución Linux y no morir en el intento
      </a>
    </li>
    
    <li>
      <a href="../la-mejor-alternativa-gratis-a-netflix/">
        2024-10-21 - La mejor alternativa gratis a Netflix
      </a>
    </li>
    
  </ul>
</div>
</div>
        <div class="sidebar-primary-item">
<div class="ablog-sidebar-item ablog__archives">
  <h3>
    <a href="../../../../blog/archive/">Archivos</a>
  </h3>
  <ul>
     
    <li>
      <a href="../../../../blog/2024/">2024 (20)</a>
    </li>
      
    <li>
      <a href="../../../../blog/2021/">2021 (1)</a>
    </li>
      
    <li>
      <a href="../../../../blog/2020/">2020 (18)</a>
    </li>
      
    <li>
      <a href="../../../../blog/2019/">2019 (7)</a>
    </li>
      
    <li>
      <a href="../../../../blog/2018/">2018 (5)</a>
    </li>
      
    <li>
      <a href="../../../../blog/2017/">2017 (2)</a>
    </li>
      
    <li>
      <a href="../../../../blog/2014/">2014 (1)</a>
    </li>
      
    <li>
      <a href="../../../../blog/2013/">2013 (8)</a>
    </li>
      
    <li>
      <a href="../../../../blog/2012/">2012 (19)</a>
    </li>
      
    <li>
      <a href="../../../../blog/2011/">2011 (30)</a>
    </li>
      
    <li>
      <a href="../../../../blog/2010/">2010 (7)</a>
    </li>
     
  </ul>
</div>
</div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../../" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Espiral de Parker con Python</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                   <section class="tex2jax_ignore mathjax_ignore" id="espiral-de-parker-con-python">
<h1>Espiral de Parker con Python<a class="headerlink" href="#espiral-de-parker-con-python" title="Link to this heading">#</a></h1>
<p>En esta entrada veremos la solución numérica a la ecuación diferencial no lineal de primer orden que modela la velocidad del viento solar en función de la distancia heliocéntrica. Una vez se obtiene este perfil de velocidad, el cual es dependiente de la temperatura se procede a transformar a coordenadas lagrangianas centradas en un punto de emisión sobre la corona. De esta forma será más natural construir un brazo de la espiral de Parker, sobre el cual evoluciona el perfil de velocidad hallado.</p>
<p>Cuando hablamos de la “espiral de Parker” nos referimos a la forma del campo magnético del Sol en nuestro sistema solar a raíz de su rotación y la interacción magnetohidrodinámica con el viento solar en expansión. Esto genera una forma de remolino en la descripción del campo magnético y es la que veremos como obtener con Python.</p>
<section id="viento-solar">
<h2>Viento solar<a class="headerlink" href="#viento-solar" title="Link to this heading">#</a></h2>
<p>El <a class="reference external" href="https://es.wikipedia.org/wiki/Viento_solar">viento solar</a> es un flujo de partículas con carga eléctrica (en su mayoría, electrones <span class="math notranslate nohighlight">\(e^-\)</span>, protones <span class="math notranslate nohighlight">\(p^+\)</span> y partículas alfa <span class="math notranslate nohighlight">\(\alpha\)</span>), emanadas desde la atmósfera solar. Estas particulas cargadas (gas ionizado o plasma), escapan de la atracción gravitacional del Sol por su alta energía cinética resultado de la temperatura de la corona solar y de la interacción con el campo magnético.</p>
<p>Las primeras menciones a su existencia corresponden a Biermann en los años 50, quien mediante la observación de la cola de los cometas (en dirección opuesta al sol), sugirió que debía existir un flujo de gas hacia afuera del Sol de forma radial. Parker toma esta observación, y asume el Sol como una masa gravitacional con simetría esférica en expansión estacionaria (con el fin de asegurar la condición de presión cero a distancia infinita) e inicialmente despreciando los efectos del campo magnético. Con estas consideraciones, se logra manifestar la dinámica del flujo de partículas hacia afuera del Sol (Parker, 1958).</p>
</section>
<section id="perfil-de-velocidad-del-viento-solar">
<h2>Perfil de velocidad del viento solar<a class="headerlink" href="#perfil-de-velocidad-del-viento-solar" title="Link to this heading">#</a></h2>
<p>En el trabajo de Parker bajo condiciones de expansión isotérmica (<span class="math notranslate nohighlight">\(\gamma = 1\)</span>) de un fluido neutro (primera aproximación al comportamiento del viendo solar), lleva a una ecuación diferencial no lineal de primer orden que relaciona la velocidad del viento solar (<span class="math notranslate nohighlight">\(u(r)\)</span>) y la distancia heliocéntrica (<span class="math notranslate nohighlight">\(r\)</span>) ((Parker, 1958), (Kivelson, 1995)).</p>
<div class="amsmath math notranslate nohighlight" id="equation-0163a78b-a699-43f2-ba15-913fc85da30c">
<span class="eqno">(1)<a class="headerlink" href="#equation-0163a78b-a699-43f2-ba15-913fc85da30c" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{du(r)}{dr} = \left(\frac{4kT}{mr} - \frac{GM}{r^2} \right)u(r)\left(u(r)^2 - \frac{2kT}{m} \right)^{-1}
\end{equation}\]</div>
<p>Con el fin de reducir la propagación de error por los ordenes de magnitud de las variables involucradas, se procede a adimensionalizar la ecuación diferencial, con base al radio y velocidad en el punto crítico (punto sónico) (Piso, 2008).</p>
<div class="amsmath math notranslate nohighlight" id="equation-e5a836ea-91b4-4c6c-81dd-fc98d925cb57">
<span class="eqno">(2)<a class="headerlink" href="#equation-e5a836ea-91b4-4c6c-81dd-fc98d925cb57" title="Permalink to this equation">#</a></span>\[\begin{eqnarray}
c_s^2 &amp; = &amp; \frac{2kT}{m}\\
r_c &amp;=&amp; \frac{GM}{2c_s^2}\\
\frac{dv}{dR} &amp;=&amp; \frac{2\left(\frac{1}{R} - \frac{1}{R^2}\right)}{v - \frac{1}{v}}
\end{eqnarray}\]</div>
<p>Donde <span class="math notranslate nohighlight">\(v\)</span> es la velocidad en velocidades sónicas (<span class="math notranslate nohighlight">\(c_s\)</span>) y <span class="math notranslate nohighlight">\(R\)</span> es el radio en radios sónicos (<span class="math notranslate nohighlight">\(r_c\)</span>). Observamos que alrededor del radio sónico y de la velocidad sónica se presenta un punto crítico que debe satisfacerse para asegurar el sentido físico de la solución. También, tenemos que esta ecuación representa un problema de valores de frontera, y en este caso la condición de frontera del problema en unidades adimensionales es <span class="math notranslate nohighlight">\(v(R_{sol}) = v_0\)</span>, donde <span class="math notranslate nohighlight">\(R_{sol}\)</span> es el radio del Sol, y es la posición desde la cuál comienza a desplazarse el flujo de partículas con una velocidad inicial <span class="math notranslate nohighlight">\(v_0\)</span> que dependerá de la densidad de partículas y la temperatura.</p>
<p>La generación de la espiral de Parker es efecto de la rotación del sol, por lo cual se aplica la transformación de coordenadas lagrangianas para sistemas rotantes, llevando a la ecuación diferencial</p>
<div class="amsmath math notranslate nohighlight" id="equation-582c5c83-74bc-4673-b1e2-e1af2f982acc">
<span class="eqno">(3)<a class="headerlink" href="#equation-582c5c83-74bc-4673-b1e2-e1af2f982acc" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{d\varphi}{dR} = \frac{-\omega}{v(R)}
\end{equation}\]</div>
</section>
<section id="solucion-analitica-y-numerica-con-python">
<h2>Solución analítica y numérica con Python<a class="headerlink" href="#solucion-analitica-y-numerica-con-python" title="Link to this heading">#</a></h2>
<p>Esta ecuación se puede solucionar analíticamente ya que la ecuación permite separación de variables y mediante integración encontrar la solución implícita. Podemos usar <a class="reference external" href="https://www.sympy.org/es/">SymPy</a>, un paquete de álgebra computacional de código abierto y libre, disponible en Python (una alternativa a paquetes comerciales como Maple y Mathematica).</p>
<p>Respecto a la solución numérica, implementaremos el método de <a class="reference external" href="https://es.wikipedia.org/wiki/M%C3%A9todo_de_Runge-Kutta#M%C3%A9todos_de_Runge-Kutta_de_cuarto_orden">Runge-Kutta 4 (RK4)</a>, y para la solución de la componente angular lo realizaremos de forma simple con el <a class="reference external" href="https://es.wikipedia.org/wiki/M%C3%A9todo_de_Euler">método de Euler</a> ya que esto evita tener que interpolar la solución de velocidad radial para conocer puntos intermedios requeridos por RK4. Para su implementación vamos a necesitar el manejo de arreglos, y esto los usaremos con <a class="reference external" href="https://numpy.org/">NumPy</a>. Por supuesto, queremos ver gráficos para entender la solución, así que usaremos <a class="reference external" href="https://matplotlib.org/">Matplotlib</a>.</p>
<p>Así que vamos a instalar, en este caso con la ayuda de UV, el cual es <a class="reference internal" href="../uv-alternativa-rapida-a-pip-y-venv/"><span class="std std-doc">una alternativa más rápida a <em>PIP</em></span></a>. El <code class="docutils literal notranslate"><span class="pre">!</span></code> es porque es una celda de Notebook, pero si estás en la terminal, puedes omitirla.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>uv<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>matplotlib<span class="w"> </span>numpy<span class="w"> </span>sympy
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Faint">Audited </span><span class=" -Color -Color-Bold -Color-Bold-Faint">3 packages</span> in 2ms
</pre></div>
</div>
</div>
</div>
<p>Iniciamos con el bloque de importación de los elementos que vamos a necesitar. Cada línea se encuentra comentado con el motivo por el cual lo requerimos para que sea claro su uso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sin</span>  <span class="c1"># Requerido para la transformación polar para ilustrar la solución de la espiral</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="c1"># Para incluir gráficos en el Notebook en lugar de ventanas emergentes</span>
<span class="c1">#%matplotlib inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># Graficador para los arreglos numéricos</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">ones</span>  <span class="c1"># Arreglos numéricos y el arreglo de unos</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">dsolve</span><span class="p">,</span>  <span class="c1"># Solucionador de ecuaciones diferenciales ordinarias</span>
    <span class="n">Eq</span><span class="p">,</span>  <span class="c1"># Permite plantear igualdades/ecuaciones</span>
    <span class="n">Function</span><span class="p">,</span>  <span class="c1"># Declara variables que representan funciones</span>
    <span class="n">init_printing</span><span class="p">,</span>  <span class="c1"># Inicializa la opción de visualización de ecuaciones</span>
    <span class="n">plot_implicit</span><span class="p">,</span>  <span class="c1"># Permite los gráficos de funciones implícitas</span>
    <span class="n">solve</span><span class="p">,</span>  <span class="c1"># Solución de ecuaciones algebraicas</span>
    <span class="n">symbols</span>  <span class="c1"># Declara símbolos generales</span>
<span class="p">)</span>
<span class="n">init_printing</span><span class="p">()</span>  <span class="c1"># Inicializa sesión de impresión en el Notebook</span>
</pre></div>
</div>
</div>
</div>
<section id="solucion-analitica">
<h3>Solución analítica<a class="headerlink" href="#solucion-analitica" title="Link to this heading">#</a></h3>
<p>El primer paso es la declaración de los símbolos requeridos. Esto es la función del perfil de velocidad y el símbolo para la distancia al centro del sol. Las funciones se declaran con <code class="docutils literal notranslate"><span class="pre">Function</span></code> y las variables adicionales con <code class="docutils literal notranslate"><span class="pre">symbols</span></code>. En ambos casos, tenemos que el argumento es un <em>string</em> de la letra que representa, y por convención lo asignamos a una variable Python con la misma letra.</p>
<p>Adicional, vamos a plantear la ecuación que previamente obtuvimos para la forma adimensional, y debemos tener en cuenta que al ser la velocidad una función, se escribe como habitualmente se dispone, indicando su forma con paréntesis y la variable de la cual depende, <span class="math notranslate nohighlight">\(v(R)\)</span>. Y para expresar la forma de la derivada, las expresiones de SymPy suportan el método <code class="docutils literal notranslate"><span class="pre">.diff</span></code> cuyo argumento es la variable respecto a la cual se deriva. En este caso, se plantearía como <code class="docutils literal notranslate"><span class="pre">v(R).diff(R)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>  <span class="c1"># Declara la función de velocidad</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>  <span class="c1"># Declara la variable de distancia</span>
<span class="c1"># Se plantea la ecuación diferencial</span>
<span class="n">eq_ord</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">R</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">R</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">v</span><span class="p">(</span><span class="n">R</span><span class="p">)))</span>
<span class="n">eq_ord</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/35d8800234d647e92c4572be54dc483d7669779b70486e941397734ae850ad68.png" src="../../../../_images/35d8800234d647e92c4572be54dc483d7669779b70486e941397734ae850ad68.png" />
</div>
</div>
<p>SymPy en los métodos soportados, dispone de la opción de separación de variables. Si necesitamos una forma particular o porque queremos dar un indicio al algoritmo, podemos añadir la opción que recomienda el método, en este caso sería <code class="docutils literal notranslate"><span class="pre">hint='separable'</span></code>. Para nuestro caso, es importante indicar el método para que luego la opción de no simplificación nos muestre la ecuación típica que se describe en el artículo de Parker. La función para la solución de ecuaciones diferenciales ordinarias, es <code class="docutils literal notranslate"><span class="pre">dsolve</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Se aplica método de separación de variables</span>
<span class="c1"># No se simplifica para mostrar la forma implícita</span>
<span class="n">sol_impl</span> <span class="o">=</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq_ord</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;separable&#39;</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sol_impl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/ae79e707f4b24ca96ac4d682230b5e7c6d1b85169c581dd69beb9d4ecddf7550.png" src="../../../../_images/ae79e707f4b24ca96ac4d682230b5e7c6d1b85169c581dd69beb9d4ecddf7550.png" />
</div>
</div>
<p>Solo para los curiosos, también podemos permitir que la solución sea simplificada y obtener la forma explícita, la cual depende de la <a class="reference external" href="https://es.wikipedia.org/wiki/Funci%C3%B3n_W_de_Lambert">función Lambert W</a>. Esta no es la forma usual en la cual encontraremos referenciada la solución, pero gracias a los sistemas de álgebra computacional podemos disponer de esta desde la década de los 90. Para ello podemos quitar la opción de no simplificar, pero también si removemos la recomendación de método, también la vamos a obtener.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq_ord</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/4bc3534ad638445c31caec6a96914d27e258f9c18d7dd4553dc75f3722ea00e2.png" src="../../../../_images/4bc3534ad638445c31caec6a96914d27e258f9c18d7dd4553dc75f3722ea00e2.png" />
</div>
</div>
<p>Ahora, para saber que valores de la constante de integración usar, debemos tener presente que la solución debe satisfacer pasar por el punto crítico, y por ende si asignamos el punto crítico, podemos despejar la constante. Para hacer la substitución usamos el método <code class="docutils literal notranslate"><span class="pre">.subs</span></code> que recibe un diccionario donde las llaves son los símbolos originales y los valores son los nuevos valores o símbolos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solve</span><span class="p">(</span><span class="n">sol_impl</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">v</span><span class="p">(</span><span class="n">R</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="n">R</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/0a5bc57b878717f1f050ead9c6dea1a4dd3fe9fde84e6d242668d9500c50b6f8.png" src="../../../../_images/0a5bc57b878717f1f050ead9c6dea1a4dd3fe9fde84e6d242668d9500c50b6f8.png" />
</div>
</div>
<p>Para poder graficar, debemos reemplazar la función de velocidad de la función implícita por un símbolo, y proceder con los cambios de la constante de integración para generar la familia de soluciones. Como ya sabemos que para pasar por el punto crítico la constante debe ser <span class="math notranslate nohighlight">\(-3/2\)</span>, vamos a usar este valor, pero también necesitamos un valor superior (ejemplo, <span class="math notranslate nohighlight">\(1\)</span>), y un valor inferior (ejemplo, <span class="math notranslate nohighlight">\(2\)</span>). Para graficar al ser una función implícita, usaremos <code class="docutils literal notranslate"><span class="pre">plot_implicit</span></code> de SymPy que hace un mallado de puntos en el plano de interes para evaluar por celda el cumplimiento de la igualdad. Usaremos <code class="docutils literal notranslate"><span class="pre">show=False</span></code> para que no se muestre cada curva por separado y poder añadir los 3 escenarios en un mismo gráfico.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>  <span class="c1"># Símbolo para la velocidad</span>
<span class="c1"># Graficamos implícitamente para 3 valores de la constante de integración</span>
<span class="c1"># show=False es para no mostrar de una vez, y poder controlar el gráfico unido</span>
<span class="c1"># extendiendo y mostrando a discreción</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">plot_implicit</span><span class="p">(</span>
    <span class="n">sol_impl</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;C1&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="p">(</span><span class="n">R</span><span class="p">):</span> <span class="n">V</span><span class="p">}),</span>
    <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">plot_implicit</span><span class="p">(</span>
    <span class="n">sol_impl</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;C1&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">v</span><span class="p">(</span><span class="n">R</span><span class="p">):</span> <span class="n">V</span><span class="p">}),</span>
    <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">plot_implicit</span><span class="p">(</span>
    <span class="n">sol_impl</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;C1&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">v</span><span class="p">(</span><span class="n">R</span><span class="p">):</span> <span class="n">V</span><span class="p">}),</span>
    <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">p1</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p3</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>  <span class="c1"># Anexamos las curvas a la misma figura</span>
<span class="n">p1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Se muestra la figura</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/569252611a8cadeaedcf4f0920a9f1d85ad476a7f5fd27b637d133eb5fda94f1.png" src="../../../../_images/569252611a8cadeaedcf4f0920a9f1d85ad476a7f5fd27b637d133eb5fda94f1.png" />
</div>
</div>
<p>Las curvas azules son referenciadas como las soluciones I y II. Son soluciones de doble evaluación y por ende no son soluciones aceptables físicamente. La curva azul de la derecha (II) además no comienza en la superficie del sol. La curva azul izquierda (I) no hace sentido además porque escaparía del Sol con velocidad subsónica y se devolvería con velocidad supersónica. Las curvas verdes (III - superior, IV - inferior) son soluciones que no pasan por el punto crítico y por ende no son aceptables físicamente. Adicional la curva III inicia con velocidad supersónica en las proximidades del Sol y eso no se ha observado, y la curva IV lleva a una presión constante en el ambiente interestelar, por lo cual no tiene sentido físico. Por el contrario, la curva roja ascendente (V), lleva a un aumento a velocidad supersónica después del punto crítico, lo cual es observado, pero además, lleva a una presión cero en el ambiente interestelar. Esta es conocida como la solución del viento solar.</p>
<div class="admonition attention">
<p class="admonition-title">Atención</p>
<p>A nivel del gráfico se observa una zona densa alrededor del punto crítico, pero esto es efecto del método de graficación implícito en modo adaptativo</p>
</div>
</section>
<section id="solucion-numerica">
<h3>Solución numérica<a class="headerlink" href="#solucion-numerica" title="Link to this heading">#</a></h3>
<p>Se observa que en el punto crítico <span class="math notranslate nohighlight">\((r_c, c_s)\)</span>, se presenta una indeterminación. Por este motivo, es necesario solucionar la ecuación diferencial antes y despues de este punto como dos tramos independientes. El tramo anterior, para asegurar su paso por el punto, lo recomendable es solucionarlo con una forma reversa (<em>backward</em>), de tal forma que se pueda usar esta información como condición inicial en la ecuación diferencial en lugar de hacer una estimación de las condiciones iniciales sobre el radio solar (y sería la misma en los dos tramos).<br />
Siendo así, tenemos que, <span class="math notranslate nohighlight">\(v(1) = 1\)</span>, para el primer tramo que va desde el radio de la corona solar hasta el punto crítico, y el segundo tramo que va desde el punto crítico hasta la Tierra (por tener un punto de referencia para la solución hacia adelante).</p>
<p>Planteamos la función para los valores numéricos del lado derecho de la ecuación diferencial (<span class="math notranslate nohighlight">\(\frac{d}{dR}v(R)\)</span>) en <code class="docutils literal notranslate"><span class="pre">f_ode</span></code> y planteamos nuestra función para el método RK4, <code class="docutils literal notranslate"><span class="pre">RK4</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_ode</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="c1"># Función de la derivada del perfil de velocidad respecto a la distancia</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">R</span><span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">v</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">RK4</span><span class="p">(</span><span class="n">funcion</span><span class="p">,</span> <span class="n">cond_inicial</span><span class="p">,</span> <span class="n">x_final</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="c1"># Implementación del solucionador de Runge Kutta orden 4</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">cond_inicial</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="n">cond_inicial</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_final</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">n</span> <span class="c1"># paso</span>
    <span class="n">dx_2</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span> <span class="c1"># medio paso</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">funcion</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">k2</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">funcion</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx_2</span><span class="p">,</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">k1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">k3</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">funcion</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx_2</span><span class="p">,</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">k2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx</span><span class="p">)</span> <span class="c1"># x[i+1] = x[-1]</span>
        <span class="n">k4</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">funcion</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">w</span>
</pre></div>
</div>
</div>
</div>
<p>Se definen las constantes requeridas y las funciones para calcular los radios y velocidades sonicas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="mf">6.67e-11</span> <span class="c1">#Nm2kg-2</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">1.38065e-23</span> <span class="c1">#JK-1</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1.988435e30</span> <span class="c1">#kg, masa del sol</span>
<span class="n">m_H</span> <span class="o">=</span> <span class="mf">1.67372e-27</span> <span class="c1">#kg, masa hidrogeno</span>
<span class="n">r_max</span> <span class="o">=</span> <span class="mf">150e9</span> <span class="c1">#m, dist tierra-sol</span>
<span class="n">r_min</span> <span class="o">=</span> <span class="mf">695.5e6</span> <span class="c1">#m, radio solar</span>
<span class="n">omega_sol</span> <span class="o">=</span> <span class="mf">2.7e-6</span> <span class="c1">#rads-1, vel angular sol</span>
<span class="n">T_cor</span> <span class="o">=</span> <span class="mf">1e6</span> <span class="c1">#K, temp corona solar</span>

<span class="k">def</span> <span class="nf">c_s</span><span class="p">(</span><span class="n">T</span> <span class="o">=</span> <span class="n">T_cor</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">m_H</span><span class="p">):</span>
    <span class="c1"># Velocidad sónica, la cual depende de la temperatura y densidad del medio</span>
    <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
    <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">m</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">r_c</span><span class="p">(</span><span class="n">T</span> <span class="o">=</span> <span class="n">T_cor</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">m_H</span><span class="p">):</span>
    <span class="c1"># Radio sónico</span>
    <span class="k">return</span> <span class="n">G</span><span class="o">*</span><span class="n">M</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">c_s</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Se determinan los parámetros en unidades adimensionales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vel_s</span> <span class="o">=</span> <span class="n">c_s</span><span class="p">(</span><span class="n">T_cor</span><span class="p">,</span> <span class="n">m_H</span><span class="p">)</span>
<span class="n">rad_s</span> <span class="o">=</span> <span class="n">r_c</span><span class="p">(</span><span class="n">T_cor</span><span class="p">,</span> <span class="n">m_H</span><span class="p">)</span>
<span class="n">t_s</span> <span class="o">=</span> <span class="n">rad_s</span> <span class="o">/</span> <span class="n">vel_s</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Velocidad sónica: </span><span class="si">{:f}</span><span class="s2">km/s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vel_s</span><span class="o">/</span><span class="mi">1000</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Radio sónico: </span><span class="si">{:f}</span><span class="s2">km&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rad_s</span><span class="o">/</span><span class="mi">1000</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unidad de tiempo: </span><span class="si">{:f}</span><span class="s2">s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t_s</span><span class="p">))</span>
<span class="n">omega_s</span> <span class="o">=</span> <span class="n">omega_sol</span> <span class="o">*</span> <span class="n">t_s</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;omega (adim): </span><span class="si">{:f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">omega_s</span><span class="p">))</span>
<span class="n">R_max</span> <span class="o">=</span> <span class="n">r_max</span> <span class="o">/</span> <span class="n">rad_s</span>
<span class="n">R_min</span> <span class="o">=</span> <span class="n">r_min</span> <span class="o">/</span> <span class="n">rad_s</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Radio máximo (adim): </span><span class="si">{:f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R_max</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Radio mínimo (adim): </span><span class="si">{:f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R_min</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Velocidad sónica: 128.444465km/s
Radio sónico: 4019540.880399km
Unidad de tiempo: 31293.998427s
omega (adim): 0.084494
Radio máximo (adim): 37.317695
Radio mínimo (adim): 0.173030
</pre></div>
</div>
</div>
</div>
<p>Ahora aplicamos el método RK4 para los tramos y gráficamos. Es necesario tener presente que al estar reverso el primer tramo, también para disponer la solución hay que aplicar el reverso de la lista (<code class="docutils literal notranslate"><span class="pre">.reverse</span></code>) y así tener la solución ordenada.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solución numérica de la ecuación de viento solar</span>
<span class="n">R</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">RK4</span><span class="p">(</span><span class="n">f_ode</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mf">1e-6</span><span class="p">],</span> <span class="n">R_min</span><span class="p">,</span> <span class="mi">30000</span><span class="p">)</span>
<span class="n">R</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="n">v</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="n">R_sup</span><span class="p">,</span> <span class="n">v_sup</span> <span class="o">=</span> <span class="n">RK4</span><span class="p">(</span><span class="n">f_ode</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span> <span class="mf">1e-6</span> <span class="p">],</span> <span class="n">R_max</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">)</span>
<span class="n">v</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">v_sup</span><span class="p">)</span>
<span class="n">R</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">R_sup</span><span class="p">)</span>
<span class="c1"># Graficamos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;or&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Punto sónico&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;og&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">.2</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">.2</span><span class="p">,</span><span class="s1">&#39;Tierra&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/6d6802b42127a79f3d66fa328ecb8675c9d01b9382efd98c07a8dbc2499050cc.png" src="../../../../_images/6d6802b42127a79f3d66fa328ecb8675c9d01b9382efd98c07a8dbc2499050cc.png" />
</div>
</div>
<p>Partiendo de este perfil de velocidad se contruye la componente angular de la velocidad para generar finalmente la conocida espiral de Parker, y lo podemos hacer con el método de Euler.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="n">cont</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">psi</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">psi</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
<span class="k">while</span> <span class="n">cont</span> <span class="o">&lt;</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
    <span class="c1"># Método de Euler</span>
    <span class="n">dR</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">R</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span>
    <span class="n">dpsi</span> <span class="o">=</span> <span class="o">-</span><span class="n">omega_s</span> <span class="o">*</span> <span class="n">dR</span> <span class="o">/</span> <span class="n">v</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span>
    <span class="n">psi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">psi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dpsi</span><span class="p">)</span>
    <span class="n">cont</span> <span class="o">=</span> <span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">dpsi_v</span> <span class="o">=</span> <span class="n">ones</span><span class="p">([</span><span class="n">N</span><span class="p">])</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">psi1</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
<span class="n">psi2</span> <span class="o">=</span> <span class="n">psi1</span> <span class="o">+</span> <span class="n">dpsi_v</span>
<span class="n">psi3</span> <span class="o">=</span> <span class="n">psi2</span> <span class="o">+</span> <span class="n">dpsi_v</span>
<span class="n">psi4</span> <span class="o">=</span> <span class="n">psi3</span> <span class="o">+</span> <span class="n">dpsi_v</span>
<span class="n">espiral</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;polar&#39;</span><span class="p">)</span>
<span class="n">espiral</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">psi1</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">espiral</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">psi2</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">espiral</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">psi3</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">espiral</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">psi4</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fcc671db7f0&gt;]
</pre></div>
</div>
<img alt="../../../../_images/91059092474e430aa770152cbdb9b3ed44d9a7e9d77897505edf9d73219b23e1.png" src="../../../../_images/91059092474e430aa770152cbdb9b3ed44d9a7e9d77897505edf9d73219b23e1.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="referencias">
<h1>Referencias<a class="headerlink" href="#referencias" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>E. N. Parker, <a class="reference external" href="https://articles.adsabs.harvard.edu/pdf/1958ApJ...128..664P">“Dynamics of the Interplanetary Gas and Magnetic Fields”</a>, Astrophysical Journal, 128, 1958 p. 664.</p></li>
<li><p>Margaret G. Kivelson y Christopher T. Russel, “Introduction to Space Physics”, Cambridge University Press, 1995, 588 p.</p></li>
<li><p>Ana Maria Piso, <a class="reference external" href="http://demonstrations.wolfram.com/TheSolarWind/">“The Solar Wind” from Wolfram Demonstrations Project</a>, Agosto 6 de 2008.</p></li>
<li><p>Richard L. Burden y J. Douglas Faires, “Análisis Numérico”, 7Ed., Ediciones Paraninfo, 2002 p. 839.</p></li>
</ul>
</section>

<div class="section ablog__blog_comments">
     
<div class="section ablog__prev-next">
  <span class="ablog__prev">
      Anterior:
    
    <a href="../agregar-google-ads-en-sphinx/">
      
      <span>Agregar Google Ads en Sphinx</span>
    </a>
    
  </span>
  <span class="ablog__spacer">&nbsp;</span>
  <span class="ablog__next">
      Siguiente: 
    <a href="../unir-video-y-audio-con-ffmpeg-y-bash/">
      <span>Unir video y audio con ffmpeg y bash</span>
      
    </a>
    
  </span>
</div>
  
</div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Espiral de Parker con Python</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#viento-solar">Viento solar</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perfil-de-velocidad-del-viento-solar">Perfil de velocidad del viento solar</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solucion-analitica-y-numerica-con-python">Solución analítica y numérica con Python</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solucion-analitica">Solución analítica</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solucion-numerica">Solución numérica</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#referencias">Referencias</a></li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../../../_sources/es/blog/2024/espiral-de-parker-con-python.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Mostrar el código
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Edward Villegas-Pulgarin.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Creado usando <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>