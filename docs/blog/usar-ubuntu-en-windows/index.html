<!DOCTYPE html>
<html lang="es" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Usar Ubuntu en Windows | Cosmoscalibur</title>
<link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" rel="stylesheet">
<link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.11.1/baguetteBox.min.css" integrity="sha256-cLMYWYYutHkt+KpNqjg7NVkYSQ+E2VbrXsEvOqU7mL0=" rel="stylesheet">
<link href="../../assets/css/all.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../rss.xml" hreflang="es" rel="alternate" title="RSS (es)" type="application/rss+xml">
<link href="../../en/rss.xml" hreflang="en" rel="alternate" title="RSS (en)" type="application/rss+xml">
<link href="https://www.cosmoscalibur.com/blog/usar-ubuntu-en-windows/" rel="canonical">
<link href="../../images/favicon.jpg" rel="icon" sizes="32x32"><!--[if lt IE 9]><script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]--><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150354242-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150354242-1');
</script>
<meta content="Edward Villegas-Pulgarin" name="author">
<link href="../crear-version-de-windows-minima-con-msmg-toolkit/" rel="prev" title="Crear versión de Windows mínima con MSMG Toolkit" type="text/html">
<meta content="Cosmoscalibur" property="og:site_name">
<meta content="Usar Ubuntu en Windows" property="og:title">
<meta content="https://www.cosmoscalibur.com/blog/usar-ubuntu-en-windows/" property="og:url">
<meta content="Como contaba en una que otra publicación, por motivos laborales mantengo mucho en Windows pero es necesario en ocasiones tener Linux a la mano. Sin duda a nivel de desarrollo Linux toma cada vez mayor" property="og:description">
<meta content="article" property="og:type">
<meta content="2020-10-05T21:22:55-05:00" property="article:published_time">
<meta content="linux" property="article:tag">
<meta content="ubuntu" property="article:tag">
<meta content="windows" property="article:tag">
<meta content="wsl" property="article:tag">
<meta content="summary" name="twitter:card">
<meta content="cosmoscalibur" name="twitter:site">
<meta content="eyvillegasp" name="twitter:creator">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Ir al contenido principal</a> <!-- Header and menu bar -->
<div class="container">
<header class="blog-header py-3">
<div class="row nbb-header align-items-center">
<div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;"><button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" data-target=".bs-nav-collapsible" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse bs-nav-collapsible bootblog4-search-form-holder"><!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Buscar en cosmoscalibur" type="text"></div>
<button class="btn btn-primary" type="submit"><span class="glyphicon glyphicon-search"></span></button> <input name="sitesearch" type="hidden" value="https://www.cosmoscalibur.com/"></form>
<!-- End of custom search --></div>
</div>
<div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;"><a class="navbar-brand blog-header-logo text-dark" href="../../"><span id="blog-title">Cosmoscalibur</span></a></div>
<div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
<nav class="navbar navbar-light bg-white">
<ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item"><a class="nav-link" href="../../en/" hreflang="en" rel="alternate">English</a></li>
</ul>
</nav>
</div>
</div>
</header>
<nav class="navbar navbar-expand-md navbar-light bg-white static-top">
<div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
<ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item"><a class="nav-link" href="../../archive.html">Archivo</a></li>
<li class="nav-item"><a class="nav-link" href="../../categories/">Etiquetas</a></li>
<li class="nav-item"><a class="nav-link" href="../../rss.xml">Canal RSS</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></nav>
</div>
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">Usar Ubuntu en Windows</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">Edward Villegas-Pulgarin</span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2020-10-05T21:22:55-05:00" itemprop="datePublished" title="2020-10-05 21:22">2020-10-05 21:22</time></a></p>
<p class="commentline"><a data-disqus-identifier="cache/posts/usar-ubuntu-en-windows.html" href="#disqus_thread">Comentarios</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div>
<p>Como contaba en una que otra publicación, por motivos laborales mantengo mucho en Windows pero es necesario en ocasiones tener Linux a la mano. Sin duda a nivel de desarrollo Linux toma cada vez mayor relevancia y es notorio cuando Microsoft le da relevancia al soporte de Linux en su ecosistema, no solo en despliegues en nube sino también en el mismo escritorio. En esto último, referimos a WSL (<em>Windows Subsystem for Linux</em>).</p>
<!-- TEASER_END -->
<p>WSL es el componente de Windows que nos permite cumplir la promesa de este artículo, ejecutar distribuciones Linux desde Windows y con rendimiento alto (no se trata de una emulación sino la ejecución de un kernel Linux real) e incluso, vincula adecuadamente con la GPU (solo para <em>Microsoft Windows Insider Program</em>).</p>
<p>Veremos como instalar una distribución Linux en Windows con WSL y es importante realizarlo en el orden mencionado.</p>
<div class="section" id="habilitar-wsl">
<h2>Habilitar WSL</h2>
<p>Nuestro primer paso es abrir la consola de Power Shell en modo administrador y a continuación ejecutaremos:</p>
<pre class="code text"><a id="rest_code_48c5955096eb489c9206fc449d9d9a13-1" name="rest_code_48c5955096eb489c9206fc449d9d9a13-1"></a>dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart
</pre></div>
<div class="section" id="actualizar-a-wsl2">
<h2>Actualizar a WSL2</h2>
<p>Si disponemos de un sistema de 64 bits (<em>x64</em>), podemos actualizar a WSL2 siempre y cuando la versión sea 1903 o superior, con número de compilación 18362 o superior. Podemos verificar ejecutando <code>winver</code> y verificar en la ventana que despliega.</p>
<p>En caso contrario, podemos recurrir al asistente de <em>Windows Update</em> para tener dicha versión. Una vez con este requisito, podemos ejecutar:</p>
<pre class="code text"><a id="rest_code_ffd19635cc7e4e02861d04077ed16caf-1" name="rest_code_ffd19635cc7e4e02861d04077ed16caf-1"></a>dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
<a id="rest_code_ffd19635cc7e4e02861d04077ed16caf-2" name="rest_code_ffd19635cc7e4e02861d04077ed16caf-2"></a>$wsl_file="wsl_update_x64.msi"
<a id="rest_code_ffd19635cc7e4e02861d04077ed16caf-3" name="rest_code_ffd19635cc7e4e02861d04077ed16caf-3"></a>$wsl_file_path=$pwd.Path + "\" + $wsl_file
<a id="rest_code_ffd19635cc7e4e02861d04077ed16caf-4" name="rest_code_ffd19635cc7e4e02861d04077ed16caf-4"></a>Invoke-WebRequest -Uri https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi -OutFile $wsl_file_path -UseBasicParsing
<a id="rest_code_ffd19635cc7e4e02861d04077ed16caf-5" name="rest_code_ffd19635cc7e4e02861d04077ed16caf-5"></a>Start-Process $wsl_file_path
<a id="rest_code_ffd19635cc7e4e02861d04077ed16caf-6" name="rest_code_ffd19635cc7e4e02861d04077ed16caf-6"></a>wsl --set-default-version 2
</pre>
<p>El procedimiento anterior es mi versión de ejecución por línea de comandos, pero la documentación oficial dispone para descarga e instalación manual. Asumo el interés en usar la WSL2 como versión por defecto, por lo cual es necesario ejecutar la última línea del bloque.</p>
</div>
<div class="section" id="instalar-distribucion-linux">
<h2>Instalar distribución Linux</h2>
<p>A través de la tienda de aplicaciones podemos continuar con la instalación de la distribución Linux deseada, pero si te interesa Ubuntu en su versión 20.04, podemos continuar en nuestra consola PowerShell ya abierta (cambiar el número de la versión LTS soportada en la URL).</p>
<pre class="code text"><a id="rest_code_e212698fb074403685b1b50e1f24b2d5-1" name="rest_code_e212698fb074403685b1b50e1f24b2d5-1"></a>Invoke-WebRequest -Uri https://aka.ms/wslubuntu2004 -OutFile Ubuntu.appx -UseBasicParsing
<a id="rest_code_e212698fb074403685b1b50e1f24b2d5-2" name="rest_code_e212698fb074403685b1b50e1f24b2d5-2"></a>Add-AppxPackage .\Ubuntu.appx
<a id="rest_code_e212698fb074403685b1b50e1f24b2d5-3" name="rest_code_e212698fb074403685b1b50e1f24b2d5-3"></a>ubuntu2004.exe
</pre>
<p>Una vez se complete el proceso, debemos inicializar la distribución para que la configuración termine. Puedes hacerlo lanzando la distribución desde la aplicación o con el comando desde la consola como en este ejemplo.</p>
<p>Concluido el proceso, será como estamos acostumbrados, creamos un usuario y contraseña durante la configuración inicial, podemos usar el gestor de paquetes e incluso lanzar algunas aplicaciones gráficas habilitando el servidor X11.</p>
<p>Finalmente, actualicemos nuestra distribución (en el paso anterior la consola ha quedado ubicada en Ubuntu).</p>
<pre class="code text"><a id="rest_code_84d81d47d08a46379777976a477a0660-1" name="rest_code_84d81d47d08a46379777976a477a0660-1"></a>sudo apt update -q
<a id="rest_code_84d81d47d08a46379777976a477a0660-2" name="rest_code_84d81d47d08a46379777976a477a0660-2"></a>sudo apt dist-upgrade -y
</pre>
<p>Hay que tener en cuenta que no todo funcionará, uno de esos detalles es la instalación de paquetes snap al igual que docker.</p>
<p>Estamos listos para usar Ubuntu en Windows. Para este fin podemos abrir nuevamente desde PowerShell y ejecutar <code>ubuntu2004.exe</code>, abrir el lanzador de Ubuntu en el menú, usar la consola Ubuntu de Windows Terminal (lo recomiendo y la reconocerá de forma inmediata) o VSCode con la extensión de <em>Remote - WSL</em>.</p>
</div>
<div class="section" id="aplicaciones-graficas">
<h2>Aplicaciones gráficas</h2>
<p>Para cerrar este tema, falta que lancemos nuestras aplicaciones gráficas. Para esto será necesario modificar el archivo <code>.bashrc</code>.</p>
<pre class="code text"><a id="rest_code_e3574bf57cd14cfe98825a3ce5d9b9d0-1" name="rest_code_e3574bf57cd14cfe98825a3ce5d9b9d0-1"></a>echo "export DISPLAY=$(awk '/nameserver / {print $2; exit}' /etc/resolv.conf 2&gt;/dev/null):0" &gt;&gt; $HOME/.bashrc
<a id="rest_code_e3574bf57cd14cfe98825a3ce5d9b9d0-2" name="rest_code_e3574bf57cd14cfe98825a3ce5d9b9d0-2"></a>echo "export LIBGL_ALWAYS_INDIRECT=1" &gt;&gt; $HOME/.bashrc
</pre>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En ningún sitio encontré referencia a necesitar reiniciar o hacer algún procesimiento adicional, pero en mi caso al intentar tras la ejecución no me funcionó, pero me funcionó después de reiniciar la máquina.</p>
</div>
<p>Ahora, instalamos <a class="reference external" href="https://sourceforge.net/projects/vcxsrv/">VcXsrv</a>. Lanzamos <em>XLaunch</em>, opción <em>Multiple Windows</em>, <em>Start no client</em> y finalmente habilitamos <em>Disable access control</em>. Este paso es necesario para iniciar el servidor X (cada que se requiera una aplicación gráfica si no lo hemos hecho durante la sesión respectiva de Windows). Para hacerlo de forma rápida, puedes guardar la configuración y lanzarlo desde dicho archivo.</p>
<p>Para probar, puedes instalar instalar <code>x11-apps</code> y lanzar <code>xclock</code>.</p>
</div>
<div class="section" id="errores-comunes">
<h2>Errores comunes</h2>
<p>Estos errores comunes son basados en lo natural que se ve ir a la tienda de aplicaciones y escoger instalar nuestra distribución.</p>
<p>Al intentar abrir la distribución de esta manera nos encontraremos con el error siguiente:</p>
<pre class="code text"><a id="rest_code_1f0390777c00464c88e2d77d23039f34-1" name="rest_code_1f0390777c00464c88e2d77d23039f34-1"></a>Installing, this may take a few minutes...
<a id="rest_code_1f0390777c00464c88e2d77d23039f34-2" name="rest_code_1f0390777c00464c88e2d77d23039f34-2"></a>WslRegisterDistribution failed with error: 0x8007019e
<a id="rest_code_1f0390777c00464c88e2d77d23039f34-3" name="rest_code_1f0390777c00464c88e2d77d23039f34-3"></a>The Windows Subsystem for Linux optional component is not enabled. Please enable it and try again.
<a id="rest_code_1f0390777c00464c88e2d77d23039f34-4" name="rest_code_1f0390777c00464c88e2d77d23039f34-4"></a>See https://aka.ms/wslinstall for details.
<a id="rest_code_1f0390777c00464c88e2d77d23039f34-5" name="rest_code_1f0390777c00464c88e2d77d23039f34-5"></a>Press any key to continue...
</pre>
<p>Esto requiere ejecutar el paso de instalación de habilitación de WSL. Una vez habilitado, debemos reinstalar la distribución, de otra manera veremos el siguiente error:</p>
<pre class="code text"><a id="rest_code_467d38938aa64fc0af5c4fdb696e0f03-1" name="rest_code_467d38938aa64fc0af5c4fdb696e0f03-1"></a>Installing, this may take a few minutes...
<a id="rest_code_467d38938aa64fc0af5c4fdb696e0f03-2" name="rest_code_467d38938aa64fc0af5c4fdb696e0f03-2"></a>WslRegisterDistribution failed with error: 0x800700b7
<a id="rest_code_467d38938aa64fc0af5c4fdb696e0f03-3" name="rest_code_467d38938aa64fc0af5c4fdb696e0f03-3"></a>The distribution installation has become corrupted.
<a id="rest_code_467d38938aa64fc0af5c4fdb696e0f03-4" name="rest_code_467d38938aa64fc0af5c4fdb696e0f03-4"></a>Please select Reset from App Settings or uninstall and reinstall the app.
<a id="rest_code_467d38938aa64fc0af5c4fdb696e0f03-5" name="rest_code_467d38938aa64fc0af5c4fdb696e0f03-5"></a>Error: 0x800700b7 Cannot create a file when that file already exists.
</pre>
<p>Por esta misma razón, nuestra distro estará en WSL1 y será necesario convertir.</p>
<pre class="code text"><a id="rest_code_b29454b20e51425fb694780c002d985b-1" name="rest_code_b29454b20e51425fb694780c002d985b-1"></a>wsl -l -v
<a id="rest_code_b29454b20e51425fb694780c002d985b-2" name="rest_code_b29454b20e51425fb694780c002d985b-2"></a>wsl --set-version Ubuntu 2
</pre>
<p>Con la primera línea verificamos la versión asignada y con el segundo convertimos.</p>
</div>
<div class="section" id="referencias">
<h2>Referencias</h2>
<ul class="simple">
<li>
<p><a class="reference external" href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">Windows Subsystem for Linux Installation Guide for Windows 10</a>.</p>
</li>
<li>
<p><a class="reference external" href="https://docs.microsoft.com/en-us/windows/wsl/install-manual">Manually download Windows Subsystem for Linux distro packages</a>.</p>
</li>
<li>
<p><a class="reference external" href="https://wiki.ubuntu.com/WSL">WSL - Ubuntu Wiki</a>.</p>
</li>
<li>
<p><a class="reference external" href="https://github.com/cascadium/wsl-windows-toolbar-launcher">WSL Windows Toolbar Launcher</a>.</p>
</li>
<li>
<p><a class="reference external" href="https://docs.nvidia.com/cuda/wsl-user-guide/index.html#abstract">CUDA on WSL User Guide</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../categories/linux/" rel="tag">linux</a></li>
<li><a class="tag p-category" href="../../categories/ubuntu/" rel="tag">ubuntu</a></li>
<li><a class="tag p-category" href="../../categories/windows/" rel="tag">windows</a></li>
<li><a class="tag p-category" href="../../categories/wsl/" rel="tag">wsl</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../crear-version-de-windows-minima-con-msmg-toolkit/" rel="prev" title="Crear versión de Windows mínima con MSMG Toolkit">Publicación anterior</a></li>
</ul>
</nav>
</aside>
<section class="comments hidden-print">
<h2>Comentarios</h2>
<div id="disqus_thread"></div>
<script>
        var disqus_shortname ="cosmoscalibur",
            disqus_url="https://www.cosmoscalibur.com/blog/usar-ubuntu-en-windows/",
        disqus_title="Usar Ubuntu en Windows",
        disqus_identifier="cache/posts/usar-ubuntu-en-windows.html",
        disqus_config = function () {
            this.language = "es_ES";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> <a class="dsq-brlink" href="https://disqus.com" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a></section>
</article>
<script>
var disqus_shortname="cosmoscalibur";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());
</script><!--End of body content-->
<footer id="footer">Si te ha sido útil o te ha gustado este contenido, <a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=R6BHD346EBXMC&amp;source=url" rel="nofollow">invítame una cerveza 🍺</a>.<br>
Contents © 2020 <a href="mailto:cosmoscalibur@gmail.com">Edward Villegas-Pulgarin</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> <a href="https://creativecommons.org/licenses/by/4.0/" rel="license"><img alt="Creative Commons License BY 4.0" src="https://licensebuttons.net/l/by/4.0/88x31.png" style="border-width:0; margin-bottom:12px;"></a></footer>
</div>
</div>
<script crossorigin="anonymous" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" src="http://code.jquery.com/jquery-3.5.1.min.js"></script>
<script crossorigin="anonymous" integrity="sha256-/ijcOLwFf26xEYAjW75FizKVo5tnTYiQddPZoLUHHZ8=" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
<script crossorigin="anonymous" integrity="sha256-ULQV01VS9LCI2ePpLsmka+W0mawFpEA0rtxnezUj4A4=" src="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.11.1/baguetteBox.min.js"></script>
<script src="../../assets/js/all.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script>
</body>
</html>
